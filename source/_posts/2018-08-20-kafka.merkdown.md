---
layout: post
title:  "kafka学习笔记"
date:	2018-08-20 13:07:11 +0800
categories: 中间件
---

> kafka是什么?
>
> 常用的消息系统有哪些？既然有了那么多的消息系统为什么还需要kafka，其设计目标是什么？

#### 消息系统的分类

 * Peer-to-Peer
 * 发布/订阅

		发布/订阅的解耦能力比p2p模型更强

#### 消息系统的适用场景

 * 解耦：各个系统之间通过消息系统这个统一的接口交换数据，无须了解彼此的存在
 * 冗余：部分消息系统具有持久化能力，可规避消息处理前丢失的风险
 * 扩展：消息系统是统一的数据接口，各系统可独立扩展
 * 削峰：消息系统可顶住峰值流量，业务系统可根据处理能力从消息系统中获取并处理对应量的请求
 * 可恢复：系统中部分组件失效并不会影响整个系统。
 * 异步通信：在不需要立即处理请求的场景下，可以将请求放入消息系统，合适的时候再处理。

#### 常用消息系统对比

 * RabbitMQ : Erlang编写，支持负载均衡，消息持久化，同时支持P2P和发布订阅模式
 * Redis ： 基于Key-Value的NoSQL数据库，同时支持MQ功能，可做轻量级消息队列使用，对短消息(小于10KB）的性能比RabbitMQ好。
 * ActiveMQ : JMS实现，Peer-to-Peer，支持持久化,XA事务。
 * Kafka/Jafka ： 高性能，跨语言的分布式 发布/订阅消息系统，支持数据持久化，同时支持在线和离线处理
 * RocketMQ : 纯Java实现，发布/订阅消息系统，支持本地事务和XA分布式事务

#### Kafka设计目标

* 高吞吐率 ： 单机可支持100万条/秒的读写
* 消息持久化 ： 所有消息均被持久化到磁盘
* 完全分布式 ： producer , broker ,sonsumer 均支持水平扩展
* 同时支持在线流式处理和离线批处理

#### kafka怎样实现异地多活方案

* kafka官方提供了一种方案：Mirror Maker，原理就是在多个数据中心之间用订阅/消费的方式搭建*数据通道*
* uReplicator是Uber开源的解决方案，追求可靠性，零丢失和易用性

#### 参考资料

[kafka官方文档](<http://kafka.apachecn.org/documentation.html#design>)

[kafka开发人员谈kafka](<https://cloud.tencent.com/developer/article/1114675>)