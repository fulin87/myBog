---
layout: post
title:	"Excel VBA工程密码破解的方法"
date:	2016-10-27 13:07:11 +0800
categories:	Excel
---

> 今天无意中发现一个破解Excel VBA工程密码的方法，经测试在2003,2007,2010这三个版本上都可以正常使用，今记录在此。

### vba工程加密之后

 对excel的VBA工程进行加密，是一种非常必要的手段，可以防止代码被人篡改。但是有时会出现密码遗忘的问题，怎么找回原来的密码或者重新设置密码呢？

 ![](/image/VBA1.PNG)

### 解决办法

 偶然间发现一个很好的解决方法，使用HXD软件直接修改。

 ![](/image/VBA2.PNG)

 + 用HXD打开excel。
 + 搜索“DPB=”，并替换成“DPx=”，保存文件。
 + 打开文件了，对VBA工程进行修改密码，这一步非常重要不然还是看不了源代码。
 + 再次打开exlel,用新的密码打开VBA工程，搞定！

 ![](/image/VBA3.PNG)

### 内部机理

 说实话，我还没有搞清楚内部的实现原理，先记录在这里，等搞明白了，在补充。